------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/Andres/Dropbox/CORNELL/Fall 2016/AEM 6700 Economics of Consumer 
> Demand/In Class assignments/5. Logit - Predicting Low Weight/logit_result.log
  log type:  text
 opened on:   8 Dec 2016, 15:49:13

. 
. * Data
.   use logit_example, clear
(Hosmer & Lemeshow data)

. 
. * Run a logit model predicting low birthweight from characteristics of the mother 
.   logit low age i.race i.smoke ptl i.ht i.ui

Iteration 0:   log likelihood =   -117.336  
Iteration 1:   log likelihood = -103.81846  
Iteration 2:   log likelihood = -103.40486  
Iteration 3:   log likelihood = -103.40384  
Iteration 4:   log likelihood = -103.40384  

Logistic regression                               Number of obs   =        189
                                                  LR chi2(7)      =      27.86
                                                  Prob > chi2     =     0.0002
Log likelihood = -103.40384                       Pseudo R2       =     0.1187

------------------------------------------------------------------------------
         low |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         age |  -.0403293   .0357127    -1.13   0.259    -.1103249    .0296663
             |
        race |
      black  |   1.009436   .5025122     2.01   0.045     .0245302    1.994342
      other  |   1.001908   .4248342     2.36   0.018     .1692485    1.834568
             |
       smoke |
     smoker  |   .9631876   .3904357     2.47   0.014     .1979477    1.728427
         ptl |   .6288678   .3399067     1.85   0.064    -.0373371    1.295073
        1.ht |   1.358142   .6289555     2.16   0.031      .125412    2.590872
        1.ui |   .8001832   .4572306     1.75   0.080    -.0959724    1.696339
       _cons |  -1.184127   .9187461    -1.29   0.197    -2.984837    .6165818
------------------------------------------------------------------------------

. 
end of do-file

. do "/var/folders/hw/wmwf0vcd4jxdz_tmk5ft0p480000gn/T//SD02045.000000"

.   margins r.smoke, contrast

Contrasts of predictive margins
Model VCE    : OIM

Expression   : Pr(low), predict()

------------------------------------------------
             |         df        chi2     P>chi2
-------------+----------------------------------
       smoke |          1        6.32     0.0119
------------------------------------------------

------------------------------------------------------------------------
                       |            Delta-method
                       |   Contrast   Std. Err.     [95% Conf. Interval]
-----------------------+------------------------------------------------
                 smoke |
(smoker vs nonsmoker)  |   .1832779   .0728814      .0404329    .3261229
------------------------------------------------------------------------

. 
end of do-file

. do "/var/folders/hw/wmwf0vcd4jxdz_tmk5ft0p480000gn/T//SD02045.000000"

.   margins r.smoke, contrast at(age=25)

Contrasts of predictive margins
Model VCE    : OIM

Expression   : Pr(low), predict()
at           : age             =          25

------------------------------------------------
             |         df        chi2     P>chi2
-------------+----------------------------------
       smoke |          1        6.19     0.0129
------------------------------------------------

------------------------------------------------------------------------
                       |            Delta-method
                       |   Contrast   Std. Err.     [95% Conf. Interval]
-----------------------+------------------------------------------------
                 smoke |
(smoker vs nonsmoker)  |   .1808089   .0726777      .0383632    .3232547
------------------------------------------------------------------------

.   /*
>   Specifying a maternal age of 25 changed the contrast to 18.1%. Our cont
> rast of 
>   probabilities changed because the -logit- model is nonlinear in the pro
> bability 
>   scale. A contrast of log odds-ratios would not have changed.

end of do-file

. do "/var/folders/hw/wmwf0vcd4jxdz_tmk5ft0p480000gn/T//SD02045.000000"

. ** AEM 6700
. ** Paper Towel: Discrete Choice Model
. ** Oct 27, 2016
. 
. clear

. cd "/Users/Andres/Dropbox/CORNELL/Fall 2016/AEM 6700 Economics of Consume
> r Demand/In Class assignments/3. Paper Towel"
/Users/Andres/Dropbox/CORNELL/Fall 2016/AEM 6700 Economics of Consumer Dema
> nd/In Class assignments/3. Paper Towel

. *log using PaperTowel_results.log, replace
. import delimited Paper_Towel_500Samples.csv
(23 vars, 2988 obs)

. save PaperTowel_raw, replace
file PaperTowel_raw.dta saved

. 
. ** Data Cleaning
.    use PaperTowel_raw, clear

.    /*  choice brand     color
>        1      Kimberly  print
>            2      Kimberly  white
>            3      Kimberly  assorte
>            4      Koch      print
>            5      Koch      white
>            6      OutsideGoods    */
.  * summarize data  
.    sum d* price* // no variation in d2 & d5: all d2 = 0 and all d5 = 1

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
          d1 |      2988    .0354752    .1850086          0          1
          d2 |      2988           0           0          0          0
          d3 |      2988    .2613788    .4394594          0          1
          d4 |      2988    .8577644    .3493501          0          1
          d5 |      2988           1           0          1          1
-------------+--------------------------------------------------------
      price1 |      2988    1.731059    .1705346       1.14       2.26
      price2 |      2988    1.854755    .0819261       1.24       2.19
      price3 |      2988    3.700441    .3434834       1.44       4.29
      price4 |      2988    6.323156    .9404638       4.84       9.99
      price5 |      2988    6.732058    1.005046       3.95      10.68

.    drop d2 d5

.  * save data  
.    save PaperTowel, replace
file PaperTowel.dta saved

.    
. ** Simple Logit Model: choice between brand "Kimberly" and "Koch"
.  * generate binary dependent variable choice_brand 
.    use PaperTowel, clear

.    gen choice_brand = 1

.    replace choice_brand = 0 if choice == 4 | choice == 5
(173 real changes made)

.    replace choice_brand = . if choice == 6
(2457 real changes made, 2457 to missing)

.    label variable choice_brand "0 if Koch, 1 if Kimberly"

.  
.  * Run logit model
.    * comapre choice between the two brand for the color "print"
.      logit choice_brand price1 price4 d1 d4 if choice == 1 | choice == 4 
> /* */

Iteration 0:   log likelihood = -143.62005  
Iteration 1:   log likelihood = -140.32823  
Iteration 2:   log likelihood = -140.31803  
Iteration 3:   log likelihood = -140.31803  

Logistic regression                               Number of obs   =        
> 226
                                                  LR chi2(4)      =       6
> .60
                                                  Prob > chi2     =     0.1
> 584
Log likelihood = -140.31803                       Pseudo R2       =     0.0
> 230

---------------------------------------------------------------------------
> ---
choice_brand |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interv
> al]
-------------+-------------------------------------------------------------
> ---
      price1 |    1.47843   .6016775     2.46   0.014     .2991638    2.657
> 696
      price4 |   .0974867   .1260215     0.77   0.439     -.149511    .3444
> 843
          d1 |    .177752    1.17516     0.15   0.880    -2.125519    2.481
> 023
          d4 |   .1964055   .4564792     0.43   0.667    -.6982772    1.091
> 088
       _cons |  -2.694744   1.514099    -1.78   0.075    -5.662325    .2728
> 364
---------------------------------------------------------------------------
> ---

.      predict p1
(option pr assumed; Pr(choice_brand))

.          sum p1

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
          p1 |      2988     .656011    .0619811    .421792   .8226094

.      * Marginal Effects
.        margins, dydx(*)

Average marginal effects                          Number of obs   =        
> 226
Model VCE    : OIM

Expression   : Pr(choice_brand), predict()
dy/dx w.r.t. : price1 price4 d1 d4

---------------------------------------------------------------------------
> ---
             |            Delta-method
             |      dy/dx   Std. Err.      z    P>|z|     [95% Conf. Interv
> al]
-------------+-------------------------------------------------------------
> ---
      price1 |    .318101    .123109     2.58   0.010     .0768118    .5593
> 901
      price4 |   .0209754   .0269853     0.78   0.437    -.0319148    .0738
> 656
          d1 |   .0382454   .2528083     0.15   0.880    -.4572498    .5337
> 406
          d4 |   .0422589   .0980726     0.43   0.667    -.1499598    .2344
> 776
---------------------------------------------------------------------------
> ---

.      * Elasticities 
.        margins, eyex(*)  

Average marginal effects                          Number of obs   =        
> 226
Model VCE    : OIM

Expression   : Pr(choice_brand), predict()
ey/ex w.r.t. : price1 price4 d1 d4

---------------------------------------------------------------------------
> ---
             |            Delta-method
             |      ey/ex   Std. Err.      z    P>|z|     [95% Conf. Interv
> al]
-------------+-------------------------------------------------------------
> ---
      price1 |   .8411344   .3408846     2.47   0.014     .1730128    1.509
> 256
      price4 |   .2045538   .2617055     0.78   0.434    -.3083795     .717
> 487
          d1 |   .0007865   .0045322     0.17   0.862    -.0080965    .0096
> 695
          d4 |   .0573574   .1315137     0.44   0.663    -.2004048    .3151
> 195
---------------------------------------------------------------------------
> ---

.    * comapre choice between the two brand for the color "white"
.      logit choice_brand price2 price5 if choice == 2 | choice == 5

Iteration 0:   log likelihood = -153.51038  
Iteration 1:   log likelihood = -146.29682  
Iteration 2:   log likelihood = -146.26744  
Iteration 3:   log likelihood = -146.26744  

Logistic regression                               Number of obs   =        
> 224
                                                  LR chi2(2)      =      14
> .49
                                                  Prob > chi2     =     0.0
> 007
Log likelihood = -146.26744                       Pseudo R2       =     0.0
> 472

---------------------------------------------------------------------------
> ---
choice_brand |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interv
> al]
-------------+-------------------------------------------------------------
> ---
      price2 |   1.791903    .910141     1.97   0.049     .0080594    3.575
> 746
      price5 |   .3681853   .1168762     3.15   0.002     .1391122    .5972
> 584
       _cons |   -5.48179   1.905979    -2.88   0.004    -9.217439    -1.74
> 614
---------------------------------------------------------------------------
> ---

.          predict p2
(option pr assumed; Pr(choice_brand))

.          sum p2

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
          p2 |      2988    .5763939    .0930925   .2862465   .8702114

.      * Marginal Effects
.        margins, dydx(*)

Average marginal effects                          Number of obs   =        
> 224
Model VCE    : OIM

Expression   : Pr(choice_brand), predict()
dy/dx w.r.t. : price2 price5

---------------------------------------------------------------------------
> ---
             |            Delta-method
             |      dy/dx   Std. Err.      z    P>|z|     [95% Conf. Interv
> al]
-------------+-------------------------------------------------------------
> ---
      price2 |   .4131727   .2027702     2.04   0.042     .0157505    .8105
> 949
      price5 |   .0848953   .0246165     3.45   0.001     .0366477    .1331
> 428
---------------------------------------------------------------------------
> ---

.      * Elasticities 
.        margins, eyex(*) 

Average marginal effects                          Number of obs   =        
> 224
Model VCE    : OIM

Expression   : Pr(choice_brand), predict()
ey/ex w.r.t. : price2 price5

---------------------------------------------------------------------------
> ---
             |            Delta-method
             |      ey/ex   Std. Err.      z    P>|z|     [95% Conf. Interv
> al]
-------------+-------------------------------------------------------------
> ---
      price2 |   1.464266   .7429208     1.97   0.049     .0081683    2.920
> 364
      price5 |   .9847314   .3077715     3.20   0.001     .3815102    1.587
> 952
---------------------------------------------------------------------------
> ---

.  
. ** Multinomial Logit  
.    mlogit choice price* d*

Iteration 0:   log likelihood = -2233.9278  
Iteration 1:   log likelihood = -2141.5755  
Iteration 2:   log likelihood = -2103.9053  
Iteration 3:   log likelihood = -2103.5658  
Iteration 4:   log likelihood = -2103.5654  
Iteration 5:   log likelihood = -2103.5654  

Multinomial logistic regression                   Number of obs   =       2
> 988
                                                  LR chi2(40)     =     260
> .72
                                                  Prob > chi2     =     0.0
> 000
Log likelihood = -2103.5654                       Pseudo R2       =     0.0
> 584

---------------------------------------------------------------------------
> ---
      choice |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interv
> al]
-------------+-------------------------------------------------------------
> ---
1            |
      price1 |   2.888462   .6787013     4.26   0.000     1.558232    4.218
> 692
      price2 |   -.494107   1.109031    -0.45   0.656    -2.667768    1.679
> 554
      price3 |  -.1921776   .3377382    -0.57   0.569    -.8541323    .4697
> 772
      price4 |   .0837342   .0951225     0.88   0.379    -.1027024    .2701
> 708
      price5 |   -.247116   .0857414    -2.88   0.004    -.4151661   -.0790
> 659
          d1 |  -1.043907    .629135    -1.66   0.097    -2.276989    .1891
> 747
          d3 |  -.3454854   .2508757    -1.38   0.168    -.8371927    .1462
> 219
          d4 |   .3106955   .2871518     1.08   0.279    -.2521117    .8735
> 027
       _cons |  -5.329491   2.818607    -1.89   0.059    -10.85386    .1948
> 781
-------------+-------------------------------------------------------------
> ---
2            |
      price1 |  -3.608501   .5719092    -6.31   0.000    -4.729423    -2.48
> 758
      price2 |   12.48021   1.372562     9.09   0.000     9.790034    15.17
> 038
      price3 |   .6880195   .3945269     1.74   0.081    -.0852389    1.461
> 278
      price4 |  -.0542981   .1109579    -0.49   0.625    -.2717715    .1631
> 754
      price5 |  -.0968304   .0972016    -1.00   0.319    -.2873419    .0936
> 812
          d1 |   .4834818   .6397751     0.76   0.450    -.7704545    1.737
> 418
          d3 |  -.2756481   .2942374    -0.94   0.349    -.8523427    .3010
> 466
          d4 |  -.0465322   .3008721    -0.15   0.877    -.6362307    .5431
> 663
       _cons |  -21.73957   3.126752    -6.95   0.000     -27.8679   -15.61
> 125
-------------+-------------------------------------------------------------
> ---
3            |
      price1 |  -1.834058   .7257676    -2.53   0.012    -3.256536   -.4115
> 797
      price2 |  -.2317039   1.625285    -0.14   0.887    -3.417205    2.953
> 797
      price3 |  -1.020567   .3017878    -3.38   0.001     -1.61206   -.4290
> 737
      price4 |   .0270235   .1357806     0.20   0.842    -.2391016    .2931
> 486
      price5 |   .0895513   .1292513     0.69   0.488    -.1637766    .3428
> 791
          d1 |  -.3556717   .7647867    -0.47   0.642    -1.854626    1.143
> 283
          d3 |   .2942176   .3188072     0.92   0.356     -.330633    .9190
> 683
          d4 |   .0830308   .3743409     0.22   0.824    -.6506639    .8167
> 256
       _cons |   2.833764   3.386884     0.84   0.403    -3.804407    9.471
> 934
-------------+-------------------------------------------------------------
> ---
4            |
      price1 |  -.1080293   .7912262    -0.14   0.891    -1.658804    1.442
> 746
      price2 |   .9186103   1.583927     0.58   0.562    -2.185829    4.023
> 049
      price3 |  -.0885912     .38979    -0.23   0.820    -.8525656    .6753
> 832
      price4 |   .0973447   .1348233     0.72   0.470    -.1669042    .3615
> 936
      price5 |   .2658212   .1264516     2.10   0.036     .0179806    .5136
> 618
          d1 |  -1.010795   1.043226    -0.97   0.333    -3.055481    1.033
> 891
          d3 |   .4094009   .3132101     1.31   0.191    -.2044796    1.023
> 281
          d4 |   .5380606    .385183     1.40   0.162    -.2168842    1.293
> 005
       _cons |  -7.696348   3.698492    -2.08   0.037    -14.94526    -.447
> 436
-------------+-------------------------------------------------------------
> ---
5            |
      price1 |  -.2030383   .7174159    -0.28   0.777    -1.609148    1.203
> 071
      price2 |   2.317377    1.51664     1.53   0.127    -.6551832    5.289
> 937
      price3 |   .4002477   .4737178     0.84   0.398    -.5282221    1.328
> 717
      price4 |  -.2014752   .1184929    -1.70   0.089     -.433717    .0307
> 667
      price5 |   -.567929   .1005183    -5.65   0.000    -.7649413   -.3709
> 168
          d1 |   -.353656   .7825223    -0.45   0.651    -1.887371     1.18
> 006
          d3 |  -.3838261   .3195009    -1.20   0.230    -1.010036    .2423
> 841
          d4 |  -.2789625   .3516452    -0.79   0.428    -.9681745    .4102
> 495
       _cons |  -3.403489   3.561078    -0.96   0.339    -10.38307    3.576
> 096
-------------+-------------------------------------------------------------
> ---
6            |  (base outcome)
---------------------------------------------------------------------------
> ---

.    predict pm1, outcome(1)
(option pr assumed; predicted probability)

.    sum pm1

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
         pm1 |      2988    .0505355    .0270885   .0058484   .2126237

.    predict pm2, outcome(2)
(option pr assumed; predicted probability)

.    sum pm2

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
         pm2 |      2988    .0421687    .0489701   .0000181   .5279129

.    predict pm3, outcome(3)
(option pr assumed; predicted probability)

.    sum pm3

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
         pm3 |      2988    .0271084    .0245395   .0057288   .2472478

.    predict pm4, outcome(4)
(option pr assumed; predicted probability)

.    sum pm4

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
         pm4 |      2988    .0251004    .0104314   .0079823   .0743966

.    predict pm5, outcome(5)
(option pr assumed; predicted probability)

.    sum pm5   

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
         pm5 |      2988    .0327979    .0263602   .0031991   .1725631

.    * Marginal Effects
.      margins, dydx(*) predict(outcome(1))

Average marginal effects                          Number of obs   =       2
> 988
Model VCE    : OIM

Expression   : Pr(choice==1), predict(outcome(1))
dy/dx w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

---------------------------------------------------------------------------
> ---
             |            Delta-method
             |      dy/dx   Std. Err.      z    P>|z|     [95% Conf. Interv
> al]
-------------+-------------------------------------------------------------
> ---
      price1 |   .1453472   .0330432     4.40   0.000     .0805838    .2101
> 107
      price2 |  -.0511209   .0510378    -1.00   0.317    -.1511531    .0489
> 113
      price3 |  -.0099597   .0158584    -0.63   0.530    -.0410417    .0211
> 222
      price4 |   .0043168   .0044764     0.96   0.335    -.0044568    .0130
> 905
      price5 |  -.0107639   .0040257    -2.67   0.007    -.0186542   -.0028
> 737
          d1 |  -.0479582    .029842    -1.61   0.108    -.1064476    .0105
> 311
          d3 |  -.0158345   .0118461    -1.34   0.181    -.0390525    .0073
> 835
          d4 |   .0146193   .0135541     1.08   0.281    -.0119463    .0411
> 848
---------------------------------------------------------------------------
> ---

.      margins, dydx(*) predict(outcome(2))

Average marginal effects                          Number of obs   =       2
> 988
Model VCE    : OIM

Expression   : Pr(choice==2), predict(outcome(2))
dy/dx w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

---------------------------------------------------------------------------
> ---
             |            Delta-method
             |      dy/dx   Std. Err.      z    P>|z|     [95% Conf. Interv
> al]
-------------+-------------------------------------------------------------
> ---
      price1 |  -.1397978   .0229109    -6.10   0.000    -.1847024   -.0948
> 932
      price2 |   .4707926   .0588435     8.00   0.000     .3554613    .5861
> 238
      price3 |   .0270983   .0149912     1.81   0.071    -.0022839    .0564
> 806
      price4 |  -.0020339    .004197    -0.48   0.628    -.0102598    .0061
> 921
      price5 |  -.0027384   .0036222    -0.76   0.450    -.0098377     .004
> 361
          d1 |   .0222228   .0242913     0.91   0.360    -.0253873    .0698
> 329
          d3 |   -.010016   .0111511    -0.90   0.369    -.0318718    .0118
> 398
          d4 |  -.0025441   .0113878    -0.22   0.823    -.0248637    .0197
> 755
---------------------------------------------------------------------------
> ---

.      margins, dydx(*) predict(outcome(3))

Average marginal effects                          Number of obs   =       2988
Model VCE    : OIM

Expression   : Pr(choice==3), predict(outcome(3))
dy/dx w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |  -.0459884   .0187998    -2.45   0.014    -.0828352   -.0091415
      price2 |  -.0216961   .0407218    -0.53   0.594    -.1015093    .0581172
      price3 |  -.0270693    .008066    -3.36   0.001    -.0428784   -.0112601
      price4 |   .0007275   .0034892     0.21   0.835    -.0061113    .0075663
      price5 |   .0028367   .0033032     0.86   0.390    -.0036375    .0093109
          d1 |  -.0075671   .0196779    -0.38   0.701     -.046135    .0310009
          d3 |   .0081702   .0082231     0.99   0.320    -.0079469    .0242872
          d4 |   .0016212   .0096202     0.17   0.866     -.017234    .0204764
------------------------------------------------------------------------------

.      margins, dydx(*) predict(outcome(4))

Average marginal effects                          Number of obs   =       2988
Model VCE    : OIM

Expression   : Pr(choice==4), predict(outcome(4))
dy/dx w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |  -.0005722   .0188327    -0.03   0.976    -.0374837    .0363393
      price2 |   .0086824   .0373889     0.23   0.816    -.0645986    .0819634
      price3 |  -.0020827    .009401    -0.22   0.825    -.0205083    .0163428
      price4 |   .0024438   .0032839     0.74   0.457    -.0039924    .0088801
      price5 |   .0071637   .0031331     2.29   0.022      .001023    .0133043
          d1 |   -.023404   .0255032    -0.92   0.359    -.0733894    .0265814
          d3 |   .0106693   .0076794     1.39   0.165     -.004382    .0257207
          d4 |   .0129184   .0094574     1.37   0.172    -.0056178    .0314545
------------------------------------------------------------------------------

.      margins, dydx(*) predict(outcome(5))   

Average marginal effects                          Number of obs   =       2988
Model VCE    : OIM

Expression   : Pr(choice==5), predict(outcome(5))
dy/dx w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |  -.0052129   .0216934    -0.24   0.810    -.0477311    .0373053
      price2 |   .0532473   .0456495     1.17   0.243     -.036224    .1427186
      price3 |   .0124935   .0146615     0.85   0.394    -.0162424    .0412295
      price4 |  -.0064182   .0036938    -1.74   0.082    -.0136578    .0008215
      price5 |  -.0172161   .0033815    -5.09   0.000    -.0238439   -.0105884
          d1 |  -.0087173   .0242442    -0.36   0.719     -.056235    .0388005
          d3 |  -.0112662   .0099217    -1.14   0.256    -.0307124      .00818
          d4 |   -.009619   .0109066    -0.88   0.378    -.0309956    .0117575
------------------------------------------------------------------------------

.          
.    * Elasticities 
.      margins, eyex(*) predict(outcome(1))

Average marginal effects                          Number of obs   =       2988
Model VCE    : OIM

Expression   : Pr(choice==1), predict(outcome(1))
ey/ex w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      ey/ex   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |   5.090177   1.109859     4.59   0.000     2.914893    7.265462
      price2 |   -2.04739   1.950317    -1.05   0.294     -5.86994     1.77516
      price3 |  -.7288236   1.182689    -0.62   0.538    -3.046851    1.589204
      price4 |   .5381998   .5684733     0.95   0.344    -.5759875    1.652387
      price5 |  -1.505507   .5480889    -2.75   0.006    -2.579742   -.4312724
          d1 |  -.0356567   .0222154    -1.61   0.108    -.0791981    .0078847
          d3 |  -.0903738   .0638436    -1.42   0.157     -.215505    .0347575
          d4 |   .2484298   .2325578     1.07   0.285     -.207375    .7042347
------------------------------------------------------------------------------

.      margins, eyex(*) predict(outcome(2))

Average marginal effects                          Number of obs   =       2988
Model VCE    : OIM

Expression   : Pr(choice==2), predict(outcome(2))
ey/ex w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      ey/ex   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |  -6.156481   .9494676    -6.48   0.000    -8.017404   -4.295559
      price2 |   22.01677   2.426447     9.07   0.000     17.26102    26.77251
      price3 |    2.52831   1.394078     1.81   0.070    -.2040318    5.260653
      price4 |  -.3346038   .6692154    -0.50   0.617    -1.646242    .9770342
      price5 |  -.4937606   .6251534    -0.79   0.430    -1.719039    .7315175
          d1 |   .0185281   .0217564     0.85   0.394    -.0241136    .0611698
          d3 |  -.0721202   .0740463    -0.97   0.330    -.2172483    .0730078
          d4 |  -.0579914   .2467262    -0.24   0.814    -.5415658     .425583
------------------------------------------------------------------------------

.      margins, eyex(*) predict(outcome(3))

Average marginal effects                          Number of obs   =       2988
Model VCE    : OIM

Expression   : Pr(choice==3), predict(outcome(3))
ey/ex w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      ey/ex   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |  -3.084874   1.222868    -2.52   0.012    -5.481652   -.6880956
      price2 |  -1.560728   2.929492    -0.53   0.594    -7.302427    4.180971
      price3 |  -3.794275   1.086758    -3.49   0.000    -5.924281   -1.664269
      price4 |   .1796083   .8339486     0.22   0.829    -1.454901    1.814117
      price5 |   .7609864   .8442363     0.90   0.367    -.8936864    2.415659
          d1 |  -.0112411   .0267451    -0.42   0.674    -.0636606    .0411784
          d3 |   .0768328   .0784805     0.98   0.328    -.0769861    .2306517
          d4 |   .0531431   .3117252     0.17   0.865     -.557827    .6641133
------------------------------------------------------------------------------

.      margins, eyex(*) predict(outcome(4))

Average marginal effects                          Number of obs   =       2988
Model VCE    : OIM

Expression   : Pr(choice==4), predict(outcome(4))
ey/ex w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      ey/ex   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |  -.0969605   1.333489    -0.07   0.942    -2.710551     2.51663
      price2 |   .5728714   2.859844     0.20   0.841    -5.032321    6.178064
      price3 |  -.3454928   1.403626    -0.25   0.806    -3.096549    2.405564
      price4 |   .6242703    .829165     0.75   0.452    -1.000863    2.249404
      price5 |   1.947674   .8268516     2.36   0.018     .3270742    3.568273
          d1 |  -.0344819   .0369589    -0.93   0.351    -.1069199    .0379562
          d3 |   .1069399   .0783428     1.37   0.172    -.0466091     .260489
          d4 |   .4434608   .3208884     1.38   0.167    -.1854689    1.072391
------------------------------------------------------------------------------

.      margins, eyex(*) predict(outcome(5))   

Average marginal effects                          Number of obs   =       2988
Model VCE    : OIM

Expression   : Pr(choice==5), predict(outcome(5))
ey/ex w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      ey/ex   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |   -.261429    1.19795    -0.22   0.827    -2.609368     2.08651
      price2 |   3.167272   2.713157     1.17   0.243    -2.150418    8.484961
      price3 |   1.463451   1.691033     0.87   0.387    -1.850913    4.777814
      price4 |  -1.265246   .7233969    -1.75   0.080    -2.683078     .152586
      price5 |  -3.665275   .6560127    -5.59   0.000    -4.951036   -2.379514
          d1 |  -.0111696   .0273563    -0.41   0.683     -.064787    .0424478
          d3 |  -.1003967   .0820826    -1.22   0.221    -.2612757    .0604822
          d4 |  -.2573656    .291209    -0.88   0.377    -.8281248    .3133936
------------------------------------------------------------------------------

. 
end of do-file

. do "/var/folders/hw/wmwf0vcd4jxdz_tmk5ft0p480000gn/T//SD02045.000000"

. ** AEM 6700
. ** Paper Towel: Discrete Choice Model
. ** Oct 27, 2016
. 
. clear

. cd "/Users/Andres/Dropbox/CORNELL/Fall 2016/AEM 6700 Economics of Consumer Demand/In Class assignm
> ents/3. Paper Towel"
/Users/Andres/Dropbox/CORNELL/Fall 2016/AEM 6700 Economics of Consumer Demand/In Class assignments/3
> . Paper Towel

. *log using PaperTowel_results.log, replace
. import delimited Paper_Towel_500Samples.csv
(23 vars, 2988 obs)

. save PaperTowel_raw, replace
file PaperTowel_raw.dta saved

. 
. ** Data Cleaning
.    use PaperTowel_raw, clear

.    /*  choice brand     color
>        1      Kimberly  print
>            2      Kimberly  white
>            3      Kimberly  assorte
>            4      Koch      print
>            5      Koch      white
>            6      OutsideGoods    */
.  * summarize data  
.    sum d* price* // no variation in d2 & d5: all d2 = 0 and all d5 = 1

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
          d1 |      2988    .0354752    .1850086          0          1
          d2 |      2988           0           0          0          0
          d3 |      2988    .2613788    .4394594          0          1
          d4 |      2988    .8577644    .3493501          0          1
          d5 |      2988           1           0          1          1
-------------+--------------------------------------------------------
      price1 |      2988    1.731059    .1705346       1.14       2.26
      price2 |      2988    1.854755    .0819261       1.24       2.19
      price3 |      2988    3.700441    .3434834       1.44       4.29
      price4 |      2988    6.323156    .9404638       4.84       9.99
      price5 |      2988    6.732058    1.005046       3.95      10.68

.    drop d2 d5

.  * save data  
.    save PaperTowel, replace
file PaperTowel.dta saved

.    
. ** Simple Logit Model: choice between brand "Kimberly" and "Koch"
.  * generate binary dependent variable choice_brand 
.    use PaperTowel, clear

.    gen choice_brand = 1

.    replace choice_brand = 0 if choice == 4 | choice == 5
(173 real changes made)

.    replace choice_brand = . if choice == 6
(2457 real changes made, 2457 to missing)

.    label variable choice_brand "0 if Koch, 1 if Kimberly"

.  
.  * Run logit model
.    * comapre choice between the two brand for the color "print"
.      logit choice_brand price1 price4 d1 d4 if choice == 1 | choice == 4 /* */

Iteration 0:   log likelihood = -143.62005  
Iteration 1:   log likelihood = -140.32823  
Iteration 2:   log likelihood = -140.31803  
Iteration 3:   log likelihood = -140.31803  

Logistic regression                               Number of obs   =        226
                                                  LR chi2(4)      =       6.60
                                                  Prob > chi2     =     0.1584
Log likelihood = -140.31803                       Pseudo R2       =     0.0230

------------------------------------------------------------------------------
choice_brand |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |    1.47843   .6016775     2.46   0.014     .2991638    2.657696
      price4 |   .0974867   .1260215     0.77   0.439     -.149511    .3444843
          d1 |    .177752    1.17516     0.15   0.880    -2.125519    2.481023
          d4 |   .1964055   .4564792     0.43   0.667    -.6982772    1.091088
       _cons |  -2.694744   1.514099    -1.78   0.075    -5.662325    .2728364
------------------------------------------------------------------------------

.      predict p1
(option pr assumed; Pr(choice_brand))

.          sum p1

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
          p1 |      2988     .656011    .0619811    .421792   .8226094

.      * Marginal Effects
.        margins, dydx(*)

Average marginal effects                          Number of obs   =        226
Model VCE    : OIM

Expression   : Pr(choice_brand), predict()
dy/dx w.r.t. : price1 price4 d1 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |    .318101    .123109     2.58   0.010     .0768118    .5593901
      price4 |   .0209754   .0269853     0.78   0.437    -.0319148    .0738656
          d1 |   .0382454   .2528083     0.15   0.880    -.4572498    .5337406
          d4 |   .0422589   .0980726     0.43   0.667    -.1499598    .2344776
------------------------------------------------------------------------------

.      * Elasticities 
.        margins, eyex(*)  

Average marginal effects                          Number of obs   =        226
Model VCE    : OIM

Expression   : Pr(choice_brand), predict()
ey/ex w.r.t. : price1 price4 d1 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      ey/ex   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |   .8411344   .3408846     2.47   0.014     .1730128    1.509256
      price4 |   .2045538   .2617055     0.78   0.434    -.3083795     .717487
          d1 |   .0007865   .0045322     0.17   0.862    -.0080965    .0096695
          d4 |   .0573574   .1315137     0.44   0.663    -.2004048    .3151195
------------------------------------------------------------------------------

.    * comapre choice between the two brand for the color "white"
.      logit choice_brand price2 price5 if choice == 2 | choice == 5

Iteration 0:   log likelihood = -153.51038  
Iteration 1:   log likelihood = -146.29682  
Iteration 2:   log likelihood = -146.26744  
Iteration 3:   log likelihood = -146.26744  

Logistic regression                               Number of obs   =        224
                                                  LR chi2(2)      =      14.49
                                                  Prob > chi2     =     0.0007
Log likelihood = -146.26744                       Pseudo R2       =     0.0472

------------------------------------------------------------------------------
choice_brand |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price2 |   1.791903    .910141     1.97   0.049     .0080594    3.575746
      price5 |   .3681853   .1168762     3.15   0.002     .1391122    .5972584
       _cons |   -5.48179   1.905979    -2.88   0.004    -9.217439    -1.74614
------------------------------------------------------------------------------

.          predict p2
(option pr assumed; Pr(choice_brand))

.          sum p2

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
          p2 |      2988    .5763939    .0930925   .2862465   .8702114

.      * Marginal Effects
.        margins, dydx(*)

Average marginal effects                          Number of obs   =        224
Model VCE    : OIM

Expression   : Pr(choice_brand), predict()
dy/dx w.r.t. : price2 price5

------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price2 |   .4131727   .2027702     2.04   0.042     .0157505    .8105949
      price5 |   .0848953   .0246165     3.45   0.001     .0366477    .1331428
------------------------------------------------------------------------------

.      * Elasticities 
.        margins, eyex(*) 

Average marginal effects                          Number of obs   =        224
Model VCE    : OIM

Expression   : Pr(choice_brand), predict()
ey/ex w.r.t. : price2 price5

------------------------------------------------------------------------------
             |            Delta-method
             |      ey/ex   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price2 |   1.464266   .7429208     1.97   0.049     .0081683    2.920364
      price5 |   .9847314   .3077715     3.20   0.001     .3815102    1.587952
------------------------------------------------------------------------------

.  
. ** Multinomial Logit  
.    mlogit choice price* d*

Iteration 0:   log likelihood = -2233.9278  
Iteration 1:   log likelihood = -2141.5755  
Iteration 2:   log likelihood = -2103.9053  
Iteration 3:   log likelihood = -2103.5658  
Iteration 4:   log likelihood = -2103.5654  
Iteration 5:   log likelihood = -2103.5654  

Multinomial logistic regression                   Number of obs   =       2988
                                                  LR chi2(40)     =     260.72
                                                  Prob > chi2     =     0.0000
Log likelihood = -2103.5654                       Pseudo R2       =     0.0584

------------------------------------------------------------------------------
      choice |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
1            |
      price1 |   2.888462   .6787013     4.26   0.000     1.558232    4.218692
      price2 |   -.494107   1.109031    -0.45   0.656    -2.667768    1.679554
      price3 |  -.1921776   .3377382    -0.57   0.569    -.8541323    .4697772
      price4 |   .0837342   .0951225     0.88   0.379    -.1027024    .2701708
      price5 |   -.247116   .0857414    -2.88   0.004    -.4151661   -.0790659
          d1 |  -1.043907    .629135    -1.66   0.097    -2.276989    .1891747
          d3 |  -.3454854   .2508757    -1.38   0.168    -.8371927    .1462219
          d4 |   .3106955   .2871518     1.08   0.279    -.2521117    .8735027
       _cons |  -5.329491   2.818607    -1.89   0.059    -10.85386    .1948781
-------------+----------------------------------------------------------------
2            |
      price1 |  -3.608501   .5719092    -6.31   0.000    -4.729423    -2.48758
      price2 |   12.48021   1.372562     9.09   0.000     9.790034    15.17038
      price3 |   .6880195   .3945269     1.74   0.081    -.0852389    1.461278
      price4 |  -.0542981   .1109579    -0.49   0.625    -.2717715    .1631754
      price5 |  -.0968304   .0972016    -1.00   0.319    -.2873419    .0936812
          d1 |   .4834818   .6397751     0.76   0.450    -.7704545    1.737418
          d3 |  -.2756481   .2942374    -0.94   0.349    -.8523427    .3010466
          d4 |  -.0465322   .3008721    -0.15   0.877    -.6362307    .5431663
       _cons |  -21.73957   3.126752    -6.95   0.000     -27.8679   -15.61125
-------------+----------------------------------------------------------------
3            |
      price1 |  -1.834058   .7257676    -2.53   0.012    -3.256536   -.4115797
      price2 |  -.2317039   1.625285    -0.14   0.887    -3.417205    2.953797
      price3 |  -1.020567   .3017878    -3.38   0.001     -1.61206   -.4290737
      price4 |   .0270235   .1357806     0.20   0.842    -.2391016    .2931486
      price5 |   .0895513   .1292513     0.69   0.488    -.1637766    .3428791
          d1 |  -.3556717   .7647867    -0.47   0.642    -1.854626    1.143283
          d3 |   .2942176   .3188072     0.92   0.356     -.330633    .9190683
          d4 |   .0830308   .3743409     0.22   0.824    -.6506639    .8167256
       _cons |   2.833764   3.386884     0.84   0.403    -3.804407    9.471934
-------------+----------------------------------------------------------------
4            |
      price1 |  -.1080293   .7912262    -0.14   0.891    -1.658804    1.442746
      price2 |   .9186103   1.583927     0.58   0.562    -2.185829    4.023049
      price3 |  -.0885912     .38979    -0.23   0.820    -.8525656    .6753832
      price4 |   .0973447   .1348233     0.72   0.470    -.1669042    .3615936
      price5 |   .2658212   .1264516     2.10   0.036     .0179806    .5136618
          d1 |  -1.010795   1.043226    -0.97   0.333    -3.055481    1.033891
          d3 |   .4094009   .3132101     1.31   0.191    -.2044796    1.023281
          d4 |   .5380606    .385183     1.40   0.162    -.2168842    1.293005
       _cons |  -7.696348   3.698492    -2.08   0.037    -14.94526    -.447436
-------------+----------------------------------------------------------------
5            |
      price1 |  -.2030383   .7174159    -0.28   0.777    -1.609148    1.203071
      price2 |   2.317377    1.51664     1.53   0.127    -.6551832    5.289937
      price3 |   .4002477   .4737178     0.84   0.398    -.5282221    1.328717
      price4 |  -.2014752   .1184929    -1.70   0.089     -.433717    .0307667
      price5 |   -.567929   .1005183    -5.65   0.000    -.7649413   -.3709168
          d1 |   -.353656   .7825223    -0.45   0.651    -1.887371     1.18006
          d3 |  -.3838261   .3195009    -1.20   0.230    -1.010036    .2423841
          d4 |  -.2789625   .3516452    -0.79   0.428    -.9681745    .4102495
       _cons |  -3.403489   3.561078    -0.96   0.339    -10.38307    3.576096
-------------+----------------------------------------------------------------
6            |  (base outcome)
------------------------------------------------------------------------------

.    predict pm1, outcome(1)
(option pr assumed; predicted probability)

.    sum pm1

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
         pm1 |      2988    .0505355    .0270885   .0058484   .2126237

.    predict pm2, outcome(2)
(option pr assumed; predicted probability)

.    sum pm2

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
         pm2 |      2988    .0421687    .0489701   .0000181   .5279129

.    predict pm3, outcome(3)
(option pr assumed; predicted probability)

.    sum pm3

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
         pm3 |      2988    .0271084    .0245395   .0057288   .2472478

.    predict pm4, outcome(4)
(option pr assumed; predicted probability)

.    sum pm4

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
         pm4 |      2988    .0251004    .0104314   .0079823   .0743966

.    predict pm5, outcome(5)
(option pr assumed; predicted probability)

.    sum pm5   

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
         pm5 |      2988    .0327979    .0263602   .0031991   .1725631

.    * Marginal Effects
.      margins, dydx(*) predict(outcome(1))

Average marginal effects                          Number of obs   =       2988
Model VCE    : OIM

Expression   : Pr(choice==1), predict(outcome(1))
dy/dx w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |   .1453472   .0330432     4.40   0.000     .0805838    .2101107
      price2 |  -.0511209   .0510378    -1.00   0.317    -.1511531    .0489113
      price3 |  -.0099597   .0158584    -0.63   0.530    -.0410417    .0211222
      price4 |   .0043168   .0044764     0.96   0.335    -.0044568    .0130905
      price5 |  -.0107639   .0040257    -2.67   0.007    -.0186542   -.0028737
          d1 |  -.0479582    .029842    -1.61   0.108    -.1064476    .0105311
          d3 |  -.0158345   .0118461    -1.34   0.181    -.0390525    .0073835
          d4 |   .0146193   .0135541     1.08   0.281    -.0119463    .0411848
------------------------------------------------------------------------------

.      margins, dydx(*) predict(outcome(2))

Average marginal effects                          Number of obs   =       2988
Model VCE    : OIM

Expression   : Pr(choice==2), predict(outcome(2))
dy/dx w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |  -.1397978   .0229109    -6.10   0.000    -.1847024   -.0948932
      price2 |   .4707926   .0588435     8.00   0.000     .3554613    .5861238
      price3 |   .0270983   .0149912     1.81   0.071    -.0022839    .0564806
      price4 |  -.0020339    .004197    -0.48   0.628    -.0102598    .0061921
      price5 |  -.0027384   .0036222    -0.76   0.450    -.0098377     .004361
          d1 |   .0222228   .0242913     0.91   0.360    -.0253873    .0698329
          d3 |   -.010016   .0111511    -0.90   0.369    -.0318718    .0118398
          d4 |  -.0025441   .0113878    -0.22   0.823    -.0248637    .0197755
------------------------------------------------------------------------------

.      margins, dydx(*) predict(outcome(3))

Average marginal effects                          Number of obs   =       2988
Model VCE    : OIM

Expression   : Pr(choice==3), predict(outcome(3))
dy/dx w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |  -.0459884   .0187998    -2.45   0.014    -.0828352   -.0091415
      price2 |  -.0216961   .0407218    -0.53   0.594    -.1015093    .0581172
      price3 |  -.0270693    .008066    -3.36   0.001    -.0428784   -.0112601
      price4 |   .0007275   .0034892     0.21   0.835    -.0061113    .0075663
      price5 |   .0028367   .0033032     0.86   0.390    -.0036375    .0093109
          d1 |  -.0075671   .0196779    -0.38   0.701     -.046135    .0310009
          d3 |   .0081702   .0082231     0.99   0.320    -.0079469    .0242872
          d4 |   .0016212   .0096202     0.17   0.866     -.017234    .0204764
------------------------------------------------------------------------------

.      margins, dydx(*) predict(outcome(4))

Average marginal effects                          Number of obs   =       2988
Model VCE    : OIM

Expression   : Pr(choice==4), predict(outcome(4))
dy/dx w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |  -.0005722   .0188327    -0.03   0.976    -.0374837    .0363393
      price2 |   .0086824   .0373889     0.23   0.816    -.0645986    .0819634
      price3 |  -.0020827    .009401    -0.22   0.825    -.0205083    .0163428
      price4 |   .0024438   .0032839     0.74   0.457    -.0039924    .0088801
      price5 |   .0071637   .0031331     2.29   0.022      .001023    .0133043
          d1 |   -.023404   .0255032    -0.92   0.359    -.0733894    .0265814
          d3 |   .0106693   .0076794     1.39   0.165     -.004382    .0257207
          d4 |   .0129184   .0094574     1.37   0.172    -.0056178    .0314545
------------------------------------------------------------------------------

.      margins, dydx(*) predict(outcome(5))   

Average marginal effects                          Number of obs   =       2988
Model VCE    : OIM

Expression   : Pr(choice==5), predict(outcome(5))
dy/dx w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |  -.0052129   .0216934    -0.24   0.810    -.0477311    .0373053
      price2 |   .0532473   .0456495     1.17   0.243     -.036224    .1427186
      price3 |   .0124935   .0146615     0.85   0.394    -.0162424    .0412295
      price4 |  -.0064182   .0036938    -1.74   0.082    -.0136578    .0008215
      price5 |  -.0172161   .0033815    -5.09   0.000    -.0238439   -.0105884
          d1 |  -.0087173   .0242442    -0.36   0.719     -.056235    .0388005
          d3 |  -.0112662   .0099217    -1.14   0.256    -.0307124      .00818
          d4 |   -.009619   .0109066    -0.88   0.378    -.0309956    .0117575
------------------------------------------------------------------------------

.          
.    * Elasticities 
.      margins, eyex(*) predict(outcome(1))

Average marginal effects                          Number of obs   =       2988
Model VCE    : OIM

Expression   : Pr(choice==1), predict(outcome(1))
ey/ex w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      ey/ex   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |   5.090177   1.109859     4.59   0.000     2.914893    7.265462
      price2 |   -2.04739   1.950317    -1.05   0.294     -5.86994     1.77516
      price3 |  -.7288236   1.182689    -0.62   0.538    -3.046851    1.589204
      price4 |   .5381998   .5684733     0.95   0.344    -.5759875    1.652387
      price5 |  -1.505507   .5480889    -2.75   0.006    -2.579742   -.4312724
          d1 |  -.0356567   .0222154    -1.61   0.108    -.0791981    .0078847
          d3 |  -.0903738   .0638436    -1.42   0.157     -.215505    .0347575
          d4 |   .2484298   .2325578     1.07   0.285     -.207375    .7042347
------------------------------------------------------------------------------

.      margins, eyex(*) predict(outcome(2))

Average marginal effects                          Number of obs   =       2988
Model VCE    : OIM

Expression   : Pr(choice==2), predict(outcome(2))
ey/ex w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      ey/ex   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |  -6.156481   .9494676    -6.48   0.000    -8.017404   -4.295559
      price2 |   22.01677   2.426447     9.07   0.000     17.26102    26.77251
      price3 |    2.52831   1.394078     1.81   0.070    -.2040318    5.260653
      price4 |  -.3346038   .6692154    -0.50   0.617    -1.646242    .9770342
      price5 |  -.4937606   .6251534    -0.79   0.430    -1.719039    .7315175
          d1 |   .0185281   .0217564     0.85   0.394    -.0241136    .0611698
          d3 |  -.0721202   .0740463    -0.97   0.330    -.2172483    .0730078
          d4 |  -.0579914   .2467262    -0.24   0.814    -.5415658     .425583
------------------------------------------------------------------------------

.      margins, eyex(*) predict(outcome(3))

Average marginal effects                          Number of obs   =       2988
Model VCE    : OIM

Expression   : Pr(choice==3), predict(outcome(3))
ey/ex w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      ey/ex   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |  -3.084874   1.222868    -2.52   0.012    -5.481652   -.6880956
      price2 |  -1.560728   2.929492    -0.53   0.594    -7.302427    4.180971
      price3 |  -3.794275   1.086758    -3.49   0.000    -5.924281   -1.664269
      price4 |   .1796083   .8339486     0.22   0.829    -1.454901    1.814117
      price5 |   .7609864   .8442363     0.90   0.367    -.8936864    2.415659
          d1 |  -.0112411   .0267451    -0.42   0.674    -.0636606    .0411784
          d3 |   .0768328   .0784805     0.98   0.328    -.0769861    .2306517
          d4 |   .0531431   .3117252     0.17   0.865     -.557827    .6641133
------------------------------------------------------------------------------

.      margins, eyex(*) predict(outcome(4))

Average marginal effects                          Number of obs   =       2988
Model VCE    : OIM

Expression   : Pr(choice==4), predict(outcome(4))
ey/ex w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      ey/ex   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |  -.0969605   1.333489    -0.07   0.942    -2.710551     2.51663
      price2 |   .5728714   2.859844     0.20   0.841    -5.032321    6.178064
      price3 |  -.3454928   1.403626    -0.25   0.806    -3.096549    2.405564
      price4 |   .6242703    .829165     0.75   0.452    -1.000863    2.249404
      price5 |   1.947674   .8268516     2.36   0.018     .3270742    3.568273
          d1 |  -.0344819   .0369589    -0.93   0.351    -.1069199    .0379562
          d3 |   .1069399   .0783428     1.37   0.172    -.0466091     .260489
          d4 |   .4434608   .3208884     1.38   0.167    -.1854689    1.072391
------------------------------------------------------------------------------

.      margins, eyex(*) predict(outcome(5))   

Average marginal effects                          Number of obs   =       2988
Model VCE    : OIM

Expression   : Pr(choice==5), predict(outcome(5))
ey/ex w.r.t. : price1 price2 price3 price4 price5 d1 d3 d4

------------------------------------------------------------------------------
             |            Delta-method
             |      ey/ex   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      price1 |   -.261429    1.19795    -0.22   0.827    -2.609368     2.08651
      price2 |   3.167272   2.713157     1.17   0.243    -2.150418    8.484961
      price3 |   1.463451   1.691033     0.87   0.387    -1.850913    4.777814
      price4 |  -1.265246   .7233969    -1.75   0.080    -2.683078     .152586
      price5 |  -3.665275   .6560127    -5.59   0.000    -4.951036   -2.379514
          d1 |  -.0111696   .0273563    -0.41   0.683     -.064787    .0424478
          d3 |  -.1003967   .0820826    -1.22   0.221    -.2612757    .0604822
          d4 |  -.2573656    .291209    -0.88   0.377    -.8281248    .3133936
------------------------------------------------------------------------------

. 
end of do-file

. graph use "/Users/Andres/Dropbox/CORNELL/Fall 2016/AEM 6700 Economics of Consumer Demand/In Class 
> assignments/8. Factorial analysis - Winery/numberofbottles-impact.gph"

. do "/var/folders/hw/wmwf0vcd4jxdz_tmk5ft0p480000gn/T//SD02045.000000"

. ** Multinomial Logit 
. ** Health Insurance Example
. ** Reference: page 1358-1360 (Example 1), 1371-1377 of the -mlogit- manual 
. 
. clear

. cd "C:\Users\Xiaoli\Dropbox\AEM 6700_XF\PaperTowel\mlogit_Example"
unable to change to C:\Users\Xiaoli\Dropbox\AEM 6700_XF\PaperTowel\mlogit_Example
r(170);

end of do-file

r(170);

. do "/var/folders/hw/wmwf0vcd4jxdz_tmk5ft0p480000gn/T//SD02045.000000"

. ** Multinomial Logit 
. ** Health Insurance Example
. ** Reference: page 1358-1360 (Example 1), 1371-1377 of the -mlogit- manual 
. 
. clear

. cd "/Users/Andres/Dropbox/CORNELL/Fall 2016/AEM 6700 Economics of Consumer Demand/In Class assignm
> ents/6. Multinomial logit - demand for health insurance"
/Users/Andres/Dropbox/CORNELL/Fall 2016/AEM 6700 Economics of Consumer Demand/In Class assignments/6
> . Multinomial logit - demand for health insurance

. *log using mlogit_result.log, replace
. 
. * Data 
.   use mlogit_example, clear
(Health insurance data)

.   /*
>   We have data on the type of health insurance available to 616 psychologically 
>   depressed subjects in the United States (Tarlov et al. 1989; Wells et al. 1989). 
>   The insurance is categorized as either an indemnity plan (that is, regular 
>   fee-for-service insurance, which may have a deductible or coinsurance rate) or 
>   a prepaid plan (a fixed up-front payment allowing subsequent unlimited use as 
>   provided, for instance, by an HMO). The third possibility is that the subject 
>   has no insurance whatsoever. We wish to explore the demographic factors 
>   associated with each subjects insurance choice. One of the demographic factors 
>   in our data is the race of the participant, coded as white or nonwhite.
>   */
. 
.   tabulate insure nonwhite, chi2 col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

           |       nonwhite
    insure |         0          1 |     Total
-----------+----------------------+----------
 Indemnity |       251         43 |       294 
           |     50.71      35.54 |     47.73 
-----------+----------------------+----------
   Prepaid |       208         69 |       277 
           |     42.02      57.02 |     44.97 
-----------+----------------------+----------
  Uninsure |        36          9 |        45 
           |      7.27       7.44 |      7.31 
-----------+----------------------+----------
     Total |       495        121 |       616 
           |    100.00     100.00 |    100.00 

          Pearson chi2(2) =   9.5599   Pr = 0.008

. 
end of do-file

. do "/var/folders/hw/wmwf0vcd4jxdz_tmk5ft0p480000gn/T//SD02045.000000"

.   mlogit insure nonwhite

Iteration 0:   log likelihood = -556.59502  
Iteration 1:   log likelihood = -551.78935  
Iteration 2:   log likelihood = -551.78348  
Iteration 3:   log likelihood = -551.78348  

Multinomial logistic regression                   Number of obs   =        616
                                                  LR chi2(2)      =       9.62
                                                  Prob > chi2     =     0.0081
Log likelihood = -551.78348                       Pseudo R2       =     0.0086

------------------------------------------------------------------------------
      insure |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
Indemnity    |  (base outcome)
-------------+----------------------------------------------------------------
Prepaid      |
    nonwhite |   .6608212   .2157321     3.06   0.002     .2379942    1.083648
       _cons |  -.1879149   .0937644    -2.00   0.045    -.3716896   -.0041401
-------------+----------------------------------------------------------------
Uninsure     |
    nonwhite |   .3779586    .407589     0.93   0.354    -.4209011    1.176818
       _cons |  -1.941934   .1782185   -10.90   0.000    -2.291236   -1.592632
------------------------------------------------------------------------------

.   mlogit insure age i.male i.nonwhite i.site

Iteration 0:   log likelihood = -555.85446  
Iteration 1:   log likelihood = -534.67443  
Iteration 2:   log likelihood = -534.36284  
Iteration 3:   log likelihood = -534.36165  
Iteration 4:   log likelihood = -534.36165  

Multinomial logistic regression                   Number of obs   =        615
                                                  LR chi2(10)     =      42.99
                                                  Prob > chi2     =     0.0000
Log likelihood = -534.36165                       Pseudo R2       =     0.0387

------------------------------------------------------------------------------
      insure |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
Indemnity    |  (base outcome)
-------------+----------------------------------------------------------------
Prepaid      |
         age |   -.011745   .0061946    -1.90   0.058    -.0238862    .0003962
      1.male |   .5616934   .2027465     2.77   0.006     .1643175    .9590693
  1.nonwhite |   .9747768   .2363213     4.12   0.000     .5115955    1.437958
             |
        site |
          2  |   .1130359   .2101903     0.54   0.591    -.2989296    .5250013
          3  |  -.5879879   .2279351    -2.58   0.010    -1.034733   -.1412433
             |
       _cons |   .2697127   .3284422     0.82   0.412    -.3740222    .9134476
-------------+----------------------------------------------------------------
Uninsure     |
         age |  -.0077961   .0114418    -0.68   0.496    -.0302217    .0146294
      1.male |   .4518496   .3674867     1.23   0.219     -.268411     1.17211
  1.nonwhite |   .2170589   .4256361     0.51   0.610    -.6171725     1.05129
             |
        site |
          2  |  -1.211563   .4705127    -2.57   0.010    -2.133751   -.2893747
          3  |  -.2078123   .3662926    -0.57   0.570    -.9257327     .510108
             |
       _cons |  -1.286943   .5923219    -2.17   0.030    -2.447872   -.1260134
------------------------------------------------------------------------------

. 
end of do-file

. do "/var/folders/hw/wmwf0vcd4jxdz_tmk5ft0p480000gn/T//SD02045.000000"

.   gen byte nonwhold=nonwhite // save real race

.   replace nonwhite=0 // make everyone white
(126 real changes made)

.   predict wpind, outcome(Indemnity) // predict probabilities
(option pr assumed; predicted probability)
(1 missing value generated)

.   predict wpp, outcome(Prepaid)
(option pr assumed; predicted probability)
(1 missing value generated)

.   predict wpnoi, outcome(Uninsure)
(option pr assumed; predicted probability)
(1 missing value generated)

.   replace nonwhite=1 // make everyone nonwhite
(644 real changes made)

.   predict nwpind, outcome(Indemnity)
(option pr assumed; predicted probability)
(1 missing value generated)

.   predict nwpp, outcome(Prepaid)
(option pr assumed; predicted probability)
(1 missing value generated)

.   predict nwpnoi, outcome(Uninsure)
(option pr assumed; predicted probability)
(1 missing value generated)

.   replace nonwhite=nonwhold // restore real race
(518 real changes made)

.   summarize wp* nwp*, sep(3)

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
       wpind |       643    .5141673    .0872679   .3092903     .71939
         wpp |       643    .4082052    .0993286   .1964103   .6502247
       wpnoi |       643    .0776275    .0360283   .0273596   .1302816
-------------+--------------------------------------------------------
      nwpind |       643    .3112809    .0817693   .1511329    .535021
        nwpp |       643     .630078    .0979976   .3871782   .8278881
      nwpnoi |       643    .0586411    .0287185   .0209648   .0933874

. 
end of do-file

. do "/var/folders/hw/wmwf0vcd4jxdz_tmk5ft0p480000gn/T//SD02045.000000"

.   margins nonwhite, predict(outcome(Indemnity)) noesample

Predictive margins                                Number of obs   =        643
Model VCE    : OIM

Expression   : Pr(insure==Indemnity), predict(outcome(Indemnity))

------------------------------------------------------------------------------
             |            Delta-method
             |     Margin   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
    nonwhite |
          0  |   .5141673   .0223485    23.01   0.000      .470365    .5579695
          1  |   .3112809   .0418049     7.45   0.000     .2293448     .393217
------------------------------------------------------------------------------

.   marginsplot

  Variables that uniquely identify margins: nonwhite

. 
end of do-file

. do "/var/folders/hw/wmwf0vcd4jxdz_tmk5ft0p480000gn/T//SD02045.000000"

.   margins, dydx(*) predict(outcome(Indemnity)) //Average marginal effects

Average marginal effects                          Number of obs   =        615
Model VCE    : OIM

Expression   : Pr(insure==Indemnity), predict(outcome(Indemnity))
dy/dx w.r.t. : age 1.male 1.nonwhite 2.site 3.site

------------------------------------------------------------------------------
             |            Delta-method
             |      dy/dx   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         age |   .0026655    .001399     1.91   0.057    -.0000765    .0054074
      1.male |  -.1295734   .0450945    -2.87   0.004    -.2179571   -.0411898
  1.nonwhite |  -.2032404   .0482554    -4.21   0.000    -.2978192   -.1086616
             |
        site |
          2  |   .0070995   .0479993     0.15   0.882    -.0869775    .1011765
          3  |   .1216165   .0505833     2.40   0.016      .022475     .220758
------------------------------------------------------------------------------
Note: dy/dx for factor levels is the discrete change from the base level.

. 
end of do-file

. do "/var/folders/hw/wmwf0vcd4jxdz_tmk5ft0p480000gn/T//SD02045.000000"

. ** Nested Logit 
. ** Restaurant Example
. 
. clear

. cd "/Users/Andres/Dropbox/CORNELL/Fall 2016/AEM 6700 Economics of Consumer Demand/In Class assignm
> ents/4. Restaurant Choice"
/Users/Andres/Dropbox/CORNELL/Fall 2016/AEM 6700 Economics of Consumer Demand/In Class assignments/4
> . Restaurant Choice

. log using nlogit_restaurant.log, replace
log file already open
r(604);

end of do-file

r(604);

. do "/var/folders/hw/wmwf0vcd4jxdz_tmk5ft0p480000gn/T//SD02045.000000"

. ** Nested Logit 
. ** Restaurant Example
. 
. clear

. cd "/Users/Andres/Dropbox/CORNELL/Fall 2016/AEM 6700 Economics of Consumer Demand/In Class assignm
> ents/4. Restaurant Choice"
/Users/Andres/Dropbox/CORNELL/Fall 2016/AEM 6700 Economics of Consumer Demand/In Class assignments/4
> . Restaurant Choice

. *log using nlogit_restaurant.log, replace
. *import delimited restaurant_nlogit.xls
. *save nlogit_restaurant, replace
. 
. use nlogit_restaurant, clear

. 
. describe

Contains data from nlogit_restaurant.dta
  obs:         2,100                          
 vars:             8                          27 Oct 2016 14:24
 size:        67,200                          
----------------------------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
----------------------------------------------------------------------------------------------------
family_id       float   %9.0g                 family ID
restaurant      float   %12.0g     names      choices of restaurants
income          float   %9.0g                 household income
cost            float   %9.0g                 average meal cost per person
kids            float   %9.0g                 number of kids in the household
rating          float   %9.0g                 ratings in local restaurant guide
distance        float   %9.0g                 distance between home and restaurant
chosen          float   %9.0g                 0 no 1 yes
----------------------------------------------------------------------------------------------------
Sorted by:  family_id

. 
. list family_id restaurant chosen kids rating distance in 1/21, sepby(fam) abbrev(10)

     +--------------------------------------------------------------+
     | family_id     restaurant   chosen   kids   rating   distance |
     |--------------------------------------------------------------|
  1. |         1      Freebirds        1      1        0   1.245553 |
  2. |         1     MamasPizza        0      1        1    2.82493 |
  3. |         1     CafeEccell        0      1        2    4.21293 |
  4. |         1    LosNortenos        0      1        3   4.167634 |
  5. |         1     WingsNmore        0      1        2   6.330531 |
  6. |         1   Christophers        0      1        4   10.19829 |
  7. |         1        MadCows        0      1        5   5.601388 |
     |--------------------------------------------------------------|
  8. |         2      Freebirds        0      3        0   4.162657 |
  9. |         2     MamasPizza        0      3        1   2.865081 |
 10. |         2     CafeEccell        0      3        2   5.337799 |
 11. |         2    LosNortenos        1      3        3   4.282864 |
 12. |         2     WingsNmore        0      3        2   8.133914 |
 13. |         2   Christophers        0      3        4   8.664631 |
 14. |         2        MadCows        0      3        5   9.119597 |
     |--------------------------------------------------------------|
 15. |         3      Freebirds        1      3        0   2.112586 |
 16. |         3     MamasPizza        0      3        1   2.215329 |
 17. |         3     CafeEccell        0      3        2   6.978715 |
 18. |         3    LosNortenos        0      3        3   5.117877 |
 19. |         3     WingsNmore        0      3        2   5.312941 |
 20. |         3   Christophers        0      3        4   9.551273 |
 21. |         3        MadCows        0      3        5   5.539806 |
     +--------------------------------------------------------------+

. 
end of do-file

. do "/var/folders/hw/wmwf0vcd4jxdz_tmk5ft0p480000gn/T//SD02045.000000"

. nlogitgen type = restaurant(fast: Freebirds | MamasPizza, ///
>     family: CafeEccell | LosNortenos| WingsNmore, fancy: Christophers | MadCows)
new variable type is generated with 3 groups
label list lb_type
lb_type:
           1 fast
           2 family
           3 fancy

. nlogittree restaurant type, choice(chosen)

tree structure specified for the nested logit model

 type    N      restaurant    N   k 
-------------------------------------
 fast   600 --- Freebirds    300  12
             +- MamasPizza   300  15
 family 900 --- CafeEccell   300  78
             |- LosNortenos  300  75
             +- WingsNmore   300  69
 fancy  600 --- Christophers 300  27
             +- MadCows      300  24
-------------------------------------
                     total  2100 300

k = number of times alternative is chosen
N = number of observations at each level

. 
end of do-file

. do "/var/folders/hw/wmwf0vcd4jxdz_tmk5ft0p480000gn/T//SD02045.000000"

. nlogitgen type_alt = restaurant(1 2, 3 4 5, 6 7)
new variable type_alt is generated with 3 groups
label list lb_type_alt
lb_type_alt:
           1 type_alt1
           2 type_alt2
           3 type_alt3

. nlogittree restaurant type_alt

tree structure specified for the nested logit model

 type_alt   N      restaurant    N 
------------------------------------
 type_alt1 600 --- Freebirds    300
                +- MamasPizza   300
 type_alt2 900 --- CafeEccell   300
                |- LosNortenos  300
                +- WingsNmore   300
 type_alt3 600 --- Christophers 300
                +- MadCows      300
------------------------------------
                        total  2100

N = number of observations at each level

. 
end of do-file

. do "/var/folders/hw/wmwf0vcd4jxdz_tmk5ft0p480000gn/T//SD02045.000000"

. nlogit chosen cost rating distance || type: income kids, base(family) || ///
>        restaurant:, noconstant case(family_id)

tree structure specified for the nested logit model

 type    N      restaurant    N   k 
-------------------------------------
 fast   600 --- Freebirds    300  12
             +- MamasPizza   300  15
 family 900 --- CafeEccell   300  78
             |- LosNortenos  300  75
             +- WingsNmore   300  69
 fancy  600 --- Christophers 300  27
             +- MadCows      300  24
-------------------------------------
                     total  2100 300

k = number of times alternative is chosen
N = number of observations at each level

Iteration 0:   log likelihood = -541.93581  
Iteration 1:   log likelihood = -517.95909  (backed up)
Iteration 2:   log likelihood = -511.99261  (backed up)
Iteration 3:   log likelihood =  -506.5559  (backed up)
Iteration 4:   log likelihood = -501.33127  (backed up)
Iteration 5:   log likelihood = -492.93121  (backed up)
Iteration 6:   log likelihood = -491.75884  
Iteration 7:   log likelihood = -490.81911  
Iteration 8:   log likelihood = -489.56195  
Iteration 9:   log likelihood = -488.58891  
Iteration 10:  log likelihood = -485.68122  
Iteration 11:  log likelihood = -485.59216  
Iteration 12:  log likelihood = -485.56202  
Iteration 13:  log likelihood = -485.51992  
Iteration 14:  log likelihood = -485.48062  
Iteration 15:  log likelihood = -485.47384  
Iteration 16:  log likelihood = -485.47333  
Iteration 17:  log likelihood = -485.47331  

RUM-consistent nested logit regression         Number of obs      =       2100
Case variable: family_id                       Number of cases    =        300

Alternative variable: restaurant               Alts per case: min =          7
                                                              avg =        7.0
                                                              max =          7

                                                  Wald chi2(7)    =      46.71
Log likelihood = -485.47331                       Prob > chi2     =     0.0000

------------------------------------------------------------------------------
      chosen |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
restaurant   |
        cost |  -.1843847   .0933975    -1.97   0.048    -.3674404   -.0013289
      rating |    .463694   .3264935     1.42   0.156    -.1762215     1.10361
    distance |  -.3797474   .1003828    -3.78   0.000    -.5764941   -.1830007
------------------------------------------------------------------------------
type equations
------------------------------------------------------------------------------
fast         |
      income |  -.0266038   .0117306    -2.27   0.023    -.0495952   -.0036123
        kids |  -.0872584   .1385026    -0.63   0.529    -.3587184    .1842016
-------------+----------------------------------------------------------------
family       |
      income |          0  (base)
        kids |          0  (base)
-------------+----------------------------------------------------------------
fancy        |
      income |   .0461827   .0090936     5.08   0.000     .0283595    .0640059
        kids |  -.3959413   .1220356    -3.24   0.001    -.6351267   -.1567559
------------------------------------------------------------------------------
dissimilarity parameters
------------------------------------------------------------------------------
type         |
   /fast_tau |   1.712878    1.48685                     -1.201295    4.627051
 /family_tau |   2.505113   .9646351                       .614463    4.395763
  /fancy_tau |   4.099844   2.810123                     -1.407896    9.607583
------------------------------------------------------------------------------
LR test for IIA (tau = 1):           chi2(3) =     6.87   Prob > chi2 = 0.0762
------------------------------------------------------------------------------

. 
end of do-file

. do "/var/folders/hw/wmwf0vcd4jxdz_tmk5ft0p480000gn/T//SD02045.000000"

. estat alternatives         

   Alternatives summary for type
  +-------------------------------------------------------------------------+
  |          Alternative                  |    Cases   Frequency    Percent |
  |  index        value             label |   present   selected   selected |
  |---------------------------------------+---------------------------------|
  |      1           1               fast |       600         27       9.00 |
  |      2           2             family |       900        222      74.00 |
  |      3           3              fancy |       600         51      17.00 |
  +-------------------------------------------------------------------------+

   Alternatives summary for restaurant
  +-------------------------------------------------------------------------+
  |          Alternative                  |    Cases   Frequency    Percent |
  |  index        value             label |   present   selected   selected |
  |---------------------------------------+---------------------------------|
  |      1           1          Freebirds |       300         12       4.00 |
  |      2           2         MamasPizza |       300         15       5.00 |
  |      3           3         CafeEccell |       300         78      26.00 |
  |      4           4        LosNortenos |       300         75      25.00 |
  |      5           5         WingsNmore |       300         69      23.00 |
  |      6           6       Christophers |       300         27       9.00 |
  |      7           7            MadCows |       300         24       8.00 |
  +-------------------------------------------------------------------------+

. predict p*
(option pr assumed)

. predict condp, condp hlevel(2)

. sort family_id type restaurant

. list restaurant type chosen p2 p1 condp in 1/14, sepby(family_id) divider

     +-----------------------------------------------------------------+
     |   restaurant |   type | chosen |       p2 |       p1 |    condp |
     |--------------+--------+--------+----------+----------+----------|
  1. |    Freebirds |   fast |      1 | .0642332 | .1189609 | .5399519 |
  2. |   MamasPizza |   fast |      0 | .0547278 | .1189609 | .4600481 |
  3. |   CafeEccell | family |      0 |  .284409 | .7738761 | .3675124 |
  4. |  LosNortenos | family |      0 | .3045242 | .7738761 | .3935051 |
  5. |   WingsNmore | family |      0 | .1849429 | .7738761 | .2389825 |
  6. | Christophers |  fancy |      0 | .0429508 |  .107163 | .4007991 |
  7. |      MadCows |  fancy |      0 | .0642122 |  .107163 | .5992009 |
     |--------------+--------+--------+----------+----------+----------|
  8. |    Freebirds |   fast |      0 | .0183578 | .0488948 | .3754559 |
  9. |   MamasPizza |   fast |      0 |  .030537 | .0488948 | .6245441 |
 10. |   CafeEccell | family |      0 | .2832149 |  .756065 | .3745907 |
 11. |  LosNortenos | family |      1 | .3038883 |  .756065 | .4019341 |
 12. |   WingsNmore | family |      0 | .1689618 |  .756065 | .2234752 |
 13. | Christophers |  fancy |      0 | .1041277 | .1950402 |  .533878 |
 14. |      MadCows |  fancy |      0 | .0909125 | .1950402 |  .466122 |
     +-----------------------------------------------------------------+

. 
end of do-file

. do "/var/folders/hw/wmwf0vcd4jxdz_tmk5ft0p480000gn/T//SD02045.000000"

. predict xb*, xb

. predict iv, iv

. list restaurant type chosen xb* iv in 1/14, sepby(family_id) divider

     +--------------------------------------------------------------------+
     |   restaurant |   type | chosen |       xb1 |       xb2 |        iv |
     |--------------+--------+--------+-----------+-----------+-----------|
  1. |    Freebirds |   fast |      1 | -1.124805 | -1.476914 | -.2459659 |
  2. |   MamasPizza |   fast |      0 | -1.124805 | -1.751229 | -.2459659 |
  3. |   CafeEccell | family |      0 |         0 | -2.181112 |  .1303341 |
  4. |  LosNortenos | family |      0 |         0 |  -2.00992 |  .1303341 |
  5. |   WingsNmore | family |      0 |         0 | -3.259229 |  .1303341 |
  6. | Christophers |  fancy |      0 |  1.405185 | -6.804211 |  -.745332 |
  7. |      MadCows |  fancy |      0 |  1.405185 | -5.155514 |  -.745332 |
     |--------------+--------+--------+-----------+-----------+-----------|
  8. |    Freebirds |   fast |      0 | -1.804794 | -2.552233 | -.5104123 |
  9. |   MamasPizza |   fast |      0 | -1.804794 | -1.680583 | -.5104123 |
 10. |   CafeEccell | family |      0 |         0 | -2.400434 |  .0237072 |
 11. |  LosNortenos | family |      1 |         0 | -2.223939 |  .0237072 |
 12. |   WingsNmore | family |      0 |         0 | -3.694409 |  .0237072 |
 13. | Christophers |  fancy |      0 |  1.490775 |  -5.35932 | -.6796131 |
 14. |      MadCows |  fancy |      0 |  1.490775 | -5.915751 | -.6796131 |
     +--------------------------------------------------------------------+

. 
end of do-file

. tab kids 

  number of |
kids in the |
  household |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        147        7.00        7.00
          1 |        329       15.67       22.67
          2 |        462       22.00       44.67
          3 |        532       25.33       70.00
          4 |        413       19.67       89.67
          5 |        175        8.33       98.00
          6 |         21        1.00       99.00
          7 |         21        1.00      100.00
------------+-----------------------------------
      Total |      2,100      100.00

. tab income 

  household |
     income |      Freq.     Percent        Cum.
------------+-----------------------------------
         10 |        238       11.33       11.33
         11 |         14        0.67       12.00
         12 |         28        1.33       13.33
         13 |         14        0.67       14.00
         14 |          7        0.33       14.33
         15 |         14        0.67       15.00
         16 |         28        1.33       16.33
         17 |         56        2.67       19.00
         18 |         14        0.67       19.67
         19 |         14        0.67       20.33
         20 |          7        0.33       20.67
         21 |         28        1.33       22.00
         22 |         14        0.67       22.67
         23 |         21        1.00       23.67
         24 |         42        2.00       25.67
         25 |         35        1.67       27.33
         26 |         21        1.00       28.33
         27 |         21        1.00       29.33
         28 |         14        0.67       30.00
         29 |         35        1.67       31.67
         30 |         21        1.00       32.67
         31 |         35        1.67       34.33
         32 |          7        0.33       34.67
         33 |         21        1.00       35.67
         34 |         21        1.00       36.67
         35 |         56        2.67       39.33
         36 |         28        1.33       40.67
         37 |         35        1.67       42.33
         38 |         35        1.67       44.00
         39 |         77        3.67       47.67
         40 |         35        1.67       49.33
         41 |         63        3.00       52.33
         42 |         42        2.00       54.33
         43 |         21        1.00       55.33
         44 |         49        2.33       57.67
         45 |         77        3.67       61.33
         46 |         63        3.00       64.33
         47 |         42        2.00       66.33
         48 |         28        1.33       67.67
         49 |         35        1.67       69.33
         50 |         42        2.00       71.33
         51 |         14        0.67       72.00
         52 |         21        1.00       73.00
         53 |         21        1.00       74.00
         54 |         49        2.33       76.33
         55 |         21        1.00       77.33
         56 |         35        1.67       79.00
         57 |         49        2.33       81.33
         58 |         42        2.00       83.33
         59 |         28        1.33       84.67
         60 |         28        1.33       86.00
         62 |          7        0.33       86.33
         63 |         21        1.00       87.33
         64 |         14        0.67       88.00
         65 |         28        1.33       89.33
         69 |          7        0.33       89.67
         70 |         14        0.67       90.33
         71 |         14        0.67       91.00
         72 |          7        0.33       91.33
         74 |         14        0.67       92.00
         75 |         21        1.00       93.00
         76 |         28        1.33       94.33
         77 |         14        0.67       95.00
         78 |         14        0.67       95.67
         79 |         14        0.67       96.33
         81 |         14        0.67       97.00
         84 |         14        0.67       97.67
         85 |         21        1.00       98.67
         86 |          7        0.33       99.00
         87 |          7        0.33       99.33
         89 |          7        0.33       99.67
        126 |          7        0.33      100.00
------------+-----------------------------------
      Total |      2,100      100.00

